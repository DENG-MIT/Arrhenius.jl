<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Get Started · Arrhenius.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Arrhenius.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><span class="tocitem">Basics</span><ul><li><a class="tocitem" href="../">Arrhenius.jl</a></li><li><a class="tocitem" href="../install/">Installation</a></li><li class="is-active"><a class="tocitem" href>Get Started</a><ul class="internal"><li><a class="tocitem" href="#Basics-and-Magic-functions!"><span>Basics and Magic functions!</span></a></li><li><a class="tocitem" href="#Examples"><span>Examples</span></a></li></ul></li><li><a class="tocitem" href="../concepts/">Concepts</a></li></ul></li><li><a class="tocitem" href="../faq/">FAQ</a></li><li><a class="tocitem" href="../api/">API Documentation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Basics</a></li><li class="is-active"><a href>Get Started</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Get Started</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/DENG-MIT/Arrhenius.jl/blob/master/docs/src/get_started.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Get-Started"><a class="docs-heading-anchor" href="#Get-Started">Get Started</a><a id="Get-Started-1"></a><a class="docs-heading-anchor-permalink" href="#Get-Started" title="Permalink"></a></h1><h2 id="Basics-and-Magic-functions!"><a class="docs-heading-anchor" href="#Basics-and-Magic-functions!">Basics and Magic functions!</a><a id="Basics-and-Magic-functions!-1"></a><a class="docs-heading-anchor-permalink" href="#Basics-and-Magic-functions!" title="Permalink"></a></h2><p>We first have to make Arrhenius.jl available in our code (along with other packages you might use):</p><pre><code class="language-julia">using Arrhenius</code></pre><p>The next step is to create the solution structure similar to Cantera by providing a YAML file as the input. The complete definition of the solution structure can be found <a href="https://github.com/DENG-MIT/Arrhenius.jl/blob/a6e77fa501f8e1bfb0b4bd244b507f0bc10f1f8c/src/DataStructure.jl#L29">here</a>. </p><pre><code class="language-julia">gas = CreateSolution(&quot;../../mechanism/JP10skeletal.yaml&quot;)
</code></pre><p>Note that you have to provide the appropriate location of the YAML file. Here we have in the <code>../mechanism</code> folder. You can find the number of species and reactions in the mechanism you provided using: </p><pre><code class="language-julia">
ns = gas.n_species
nr = gas.n_reactions
</code></pre><p>To view the species that your mechanism uses:</p><pre><code class="language-julia">species_arr = gas.species_names</code></pre><p>You might also want to access a particular species&#39; data. For instance, N2&#39;s index can be accessed using: </p><pre><code class="language-julia">index_N2 = species_index(gas,&quot;N2&quot;)</code></pre><p>To get the molecular weights of each gas: </p><pre><code class="language-julia">mol_wt_arr = gas.MW</code></pre><p>Hence the mean molecular weight can be obtained as: </p><pre><code class="language-julia">mean_MW = 1. / dot(Y, 1 ./ gas.MW)
#get the density using the ideal gas law
ρ_mass = P / R / T * mean_MW</code></pre><p>Note that one has to include <code>using LinearAlgebra</code> in the code to be able to use <code>dot()</code>. One can easily convert between the mass and molar fractions:</p><pre><code class="language-julia">X = Y2X(gas, Y, mean_MW)
C = Y2C(gas, Y, ρ_mass)</code></pre><p>Some other commonly used thermodynamic functions are given below: </p><pre><code class="language-julia">#molar specific heats
cp_mole, cp_mass = get_cp(gas, T, X, mean_MW)
#molar enthalpies
h_mole = get_H(gas, T, Y, X)
#entropy
S0 = get_S(gas, T, P, X)</code></pre><p>One of the core functionalities of the Arrhenius.jl is its ability to compute the source term that frequently appears in the governing equations of chemical systems. One can simply compute this using : </p><pre><code class="language-julia">w_dot = wdot_func(gas.reaction, T, C, S0, h_mole)</code></pre><h2 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h2><h3 id="JP10-Pyrolysis"><a class="docs-heading-anchor" href="#JP10-Pyrolysis">JP10 Pyrolysis</a><a id="JP10-Pyrolysis-1"></a><a class="docs-heading-anchor-permalink" href="#JP10-Pyrolysis" title="Permalink"></a></h3><p>Let us compute the evolution of the mass fractions of C10H16 species as JP-10 is subjected to isobaric pyrolysis at 1 atm and an initial temperature of 1200K. We first include all our packages: </p><pre><code class="language-julia">using Arrhenius
using LinearAlgebra
using DifferentialEquations
using ForwardDiff
using DiffEqSensitivity
using Plots
using DelimitedFiles
using Profile</code></pre><p>Then create the gas object: </p><pre><code class="language-julia">gas = CreateSolution(&quot;../../mechanism/JP10skeletal.yaml&quot;)</code></pre><p>Declare the initial conditions as arrays: </p><pre><code class="language-julia">Y0 = zeros(ns)
Y0[species_index(gas, &quot;C10H16&quot;)] = 0.05
Y0[species_index(gas, &quot;N2&quot;)] = 0.95
T0 = 1200.0   #K
P = one_atm
u0 = vcat(Y0, T0);</code></pre><p>Create a function to define the ODE problem (for more details on solving differential equations refer to <a href="https://diffeq.sciml.ai/stable/">DifferentialEquations.jl</a>. </p><pre><code class="language-julia">@inbounds function dudt!(du, u, p, t)
    T = u[end]
    Y = @view(u[1:ns])
    mean_MW = 1. / dot(Y, 1 ./ gas.MW)
    ρ_mass = P / R / T * mean_MW
    X = Y2X(gas, Y, mean_MW)
    C = Y2C(gas, Y, ρ_mass)
    cp_mole, cp_mass = get_cp(gas, T, X, mean_MW)
    h_mole = get_H(gas, T, Y, X)
    S0 = get_S(gas, T, P, X)
    wdot = wdot_func(gas.reaction, T, C, S0, h_mole)
    Ydot = wdot / ρ_mass .* gas.MW
    Tdot = -dot(h_mole, wdot) / ρ_mass / cp_mass
    du .= vcat(Ydot, Tdot)
end</code></pre><p>Solve the ODE problem: </p><pre><code class="language-julia">tspan = [0.0, 0.07];
prob = ODEProblem(dudt!, u0, tspan);
sol = solve(prob, TRBDF2(), reltol=1e-6, abstol=1e-9);</code></pre><p>Great! Let us now compare our solution with cantera by first loading the cantera data: </p><pre><code class="language-julia">cantera_data = readdlm(&quot;pyrolysis.dat&quot;)
ct_ts= cantera_data[:, 1]
ct_T = cantera_data[:, 2]
ct_Y = cantera_data[:, 3:end];</code></pre><p>Now plot and compare away: </p><pre><code class="language-julia">plt = plot(sol.t, sol[species_index(gas, &quot;C10H16&quot;), :], lw=2, label=&quot;Arrhenius.jl&quot;);
plot!(plt, ct_ts, ct_Y[:, species_index(gas, &quot;C10H16&quot;)], label=&quot;Cantera&quot;)
ylabel!(plt, &quot;Mass Fraction of C10H16&quot;)
xlabel!(plt, &quot;Time [s]&quot;)
pltT = plot(sol.t, sol[end, :], lw=2, label=&quot;Arrhenius.jl&quot;);
plot!(pltT, ct_ts, ct_T, label=&quot;Cantera&quot;)
ylabel!(pltT, &quot;Temperature [K]&quot;)
xlabel!(pltT, &quot;Time [s]&quot;)
title!(plt, &quot;JP10 pyrolysis @1200K/1atm&quot;)
pltsum = plot(plt, pltT, legend=true, framestyle=:box)</code></pre><p>You should get a plot something like this: </p><p><img src="../figures/JP10.png" alt="JP10"/></p><h3 id="Sensitivity-analysis-using-Julia&#39;s-DiffEqSensitivity.jl"><a class="docs-heading-anchor" href="#Sensitivity-analysis-using-Julia&#39;s-DiffEqSensitivity.jl">Sensitivity analysis using Julia&#39;s DiffEqSensitivity.jl</a><a id="Sensitivity-analysis-using-Julia&#39;s-DiffEqSensitivity.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Sensitivity-analysis-using-Julia&#39;s-DiffEqSensitivity.jl" title="Permalink"></a></h3><p>In the previous example, we can easily perform a sensitivity analysis using Julia&#39;s <a href="https://diffeq.sciml.ai/latest/analysis/sensitivity/"><code>DiffEqSensitivity.jl</code></a>:</p><pre><code class="language-julia">sensealg = ForwardDiffSensitivity()
alg = TRBDF2()
# alg = Tsit5()
function fsol(u0)
    sol = solve(prob, u0=u0, alg, tspan = (0.0, 7.e-2),
                reltol=1e-3, abstol=1e-6, sensealg=sensealg)
    return sol[end, end]
end
u0[end] = 1200.0 + rand()
println(&quot;timing ode solver ...&quot;)
@time fsol(u0)
@time fsol(u0)
@time ForwardDiff.gradient(fsol, u0)</code></pre><p>The results are quite promising, with sensitivity computed in less than 2 seconds! </p><pre><code class="language-julia">julia&gt;timing ode solver ...
0.405083 seconds (614.32 k allocations: 45.126 MiB)
0.036229 seconds (16.72 k allocations: 11.618 MiB)
1.517267 seconds (183.25 k allocations: 864.085 MiB, 7.46% gc time)</code></pre><h3 id="Exploiting-Julia&#39;s-Auto-Differentiation-(AD)-package-to-compute-Jacobians"><a class="docs-heading-anchor" href="#Exploiting-Julia&#39;s-Auto-Differentiation-(AD)-package-to-compute-Jacobians">Exploiting Julia&#39;s Auto-Differentiation (AD) package to compute Jacobians</a><a id="Exploiting-Julia&#39;s-Auto-Differentiation-(AD)-package-to-compute-Jacobians-1"></a><a class="docs-heading-anchor-permalink" href="#Exploiting-Julia&#39;s-Auto-Differentiation-(AD)-package-to-compute-Jacobians" title="Permalink"></a></h3><p>Julia&#39;s automatic differentiation packages like <a href="https://juliadiff.org/ForwardDiff.jl/stable/user/api/"><code>ForwardDiff.jl</code></a> can be exploited thoroughly using Arrhenius.jl to compute the Jacobian that frequently pops up while integrating stiff systems in chemically reactive flows. We present to you an example using the LiDryer 9-species H2 combustion mechanism. So let&#39;s import packages:</p><pre><code class="language-julia">using Arrhenius
using LinearAlgebra
using DifferentialEquations
using ForwardDiff
using DiffEqSensitivity
using Plots
using DelimitedFiles
using Profile</code></pre><p>Next input the YAML:</p><pre><code class="language-julia">gas = CreateSolution(&quot;.../../mechanism/LiDryer.yaml&quot;)</code></pre><p>We use a 9-species + 24-reaction model:</p><pre><code class="language-julia">julia&gt; ns = gas.n_species
9
julia&gt; ns = gas.n_species
24</code></pre><p>View the participating species:</p><pre><code class="language-julia">julia&gt; gas.species_names
9-element Array{String,1}:
 &quot;H2&quot;
 &quot;O2&quot;
 &quot;N2&quot;
 &quot;H&quot;
 &quot;O&quot;
 &quot;OH&quot;
 &quot;HO2&quot;
 &quot;H2O2&quot;
 &quot;H2O&quot;</code></pre><p>Let&#39;s set the initial conditions: </p><pre><code class="language-julia">Y0 = zeros(ns)
Y0[species_index(gas, &quot;H2&quot;)] = 0.055463
Y0[species_index(gas, &quot;O2&quot;)] = 0.22008
Y0[species_index(gas, &quot;N2&quot;)] = 0.724457  #to sum as unity
T0 = 1100.0   #K
P = one_atm * 10.0
u0 = vcat(Y0, T0);</code></pre><p>Create the differential function:</p><pre><code class="language-julia">function dudt(u)
    T = u[end]
    Y = @view(u[1:ns])
    mean_MW = 1. / dot(Y, 1 ./ gas.MW)
    ρ_mass = P / R / T * mean_MW
    X = Y2X(gas, Y, mean_MW)
    C = Y2C(gas, Y, ρ_mass)
    cp_mole, cp_mass = get_cp(gas, T, X, mean_MW)
    h_mole = get_H(gas, T, Y, X)
    S0 = get_S(gas, T, P, X)
    wdot = wdot_func(gas.reaction, T, C, S0, h_mole)
    Ydot = wdot / ρ_mass .* gas.MW
    Tdot = -dot(h_mole, wdot) / ρ_mass / cp_mass
    du = vcat(Ydot, Tdot)
end</code></pre><p>Now computing the jacobian w/ref to the initial condition vector is as simple as: </p><pre><code class="language-julia">julia&gt; @time du0 = ForwardDiff.jacobian(dudt, u0)
 0.026856 seconds (18.37 k allocations: 1.047 MiB)
10×10 Array{Float64,2}:
  -0.00227393    -0.000934232   0.000137514  …   0.000213839  -5.21262e-6
  -0.0360919     -0.0148282     0.00218263       0.00334244   -8.27348e-5
   0.0            0.0           0.0              0.0           0.0
   0.00113697     0.000467116  -6.87571e-5      -0.000106919   2.60631e-6
   2.09985e-12    2.28459e-12  -1.26987e-13      2.97389e-12   2.53222e-14
   0.0            0.0           0.0          …   2.74378e-5    0.0
   0.0372289      0.0152953    -0.00225138      -0.00344774    8.53411e-5
   0.0            0.0           0.0              0.0           0.0
   0.0            0.0           0.0             -2.9064e-5     0.0
 -27.3692       -47.4374       16.5061          29.0894       -0.306451</code></pre><h3 id="Auto-ignition"><a class="docs-heading-anchor" href="#Auto-ignition">Auto-ignition</a><a id="Auto-ignition-1"></a><a class="docs-heading-anchor-permalink" href="#Auto-ignition" title="Permalink"></a></h3><p>Here we use the GRI30 methane combustion mechanism to compute the ignition delay time of a premixed methane-air mixture @ 980K/15 atm. The implementation is quite similar. Let&#39;s say you want to set ICs in-terms of the mole-fractions, one may eventually convert them to mass-fractions as follows: </p><pre><code class="language-julia">X0 = zeros(ns);
X0[species_index(gas, &quot;CH4&quot;)] = 1.0 / 2.0
X0[species_index(gas, &quot;O2&quot;)] = 1.0
X0[species_index(gas, &quot;N2&quot;)] = 3.76
X0 = X0 ./ sum(X0);
Y0 = X2Y(gas, X0, dot(X0, gas.MW));</code></pre><p>The integrator function remains the same: </p><pre><code class="language-julia">u0 = vcat(Y0, T0)
@inbounds function dudt!(du, u, p, t)
    T = u[end]
    Y = @view(u[1:ns])
    mean_MW = 1.0 / dot(Y, 1 ./ gas.MW)
    ρ_mass = P / R / T * mean_MW
    X = Y2X(gas, Y, mean_MW)
    C = Y2C(gas, Y, ρ_mass)
    cp_mole, cp_mass = get_cp(gas, T, X, mean_MW)
    h_mole = get_H(gas, T, Y, X)
    S0 = get_S(gas, T, P, X)
    wdot = wdot_func(gas.reaction, T, C, S0, h_mole)
    Ydot = wdot / ρ_mass .* gas.MW
    Tdot = -dot(h_mole, wdot) / ρ_mass / cp_mass
    du .= vcat(Ydot, Tdot)
end</code></pre><p>We then integrate using DifferentialEquations.jl</p><pre><code class="language-julia">tspan = [0.0, 0.1];
prob = ODEProblem(dudt!, u0, tspan);
@time sol = solve(prob, CVODE_BDF(), reltol = 1e-6, abstol = 1e-9)</code></pre><p>After running <a href="https://github.com/DENG-MIT/Arrhenius.jl/blob/main/example/ignition/ignition.jl">ignition.jl</a> you should get a plot as follows: <br/><img src="https://github.com/DENG-MIT/Arrhenius.jl/blob/main/example/ignition/CH4_ignition.png" alt="plot"/></p><h3 id="Sensitivity-analysis-of-ignition-delay-times-Active-subspaces"><a class="docs-heading-anchor" href="#Sensitivity-analysis-of-ignition-delay-times-Active-subspaces">Sensitivity analysis of ignition delay times-Active subspaces</a><a id="Sensitivity-analysis-of-ignition-delay-times-Active-subspaces-1"></a><a class="docs-heading-anchor-permalink" href="#Sensitivity-analysis-of-ignition-delay-times-Active-subspaces" title="Permalink"></a></h3><h3 id="Perfect-Stirred-reactor"><a class="docs-heading-anchor" href="#Perfect-Stirred-reactor">Perfect Stirred reactor</a><a id="Perfect-Stirred-reactor-1"></a><a class="docs-heading-anchor-permalink" href="#Perfect-Stirred-reactor" title="Permalink"></a></h3><p>One may refer to the <a href="https://github.com/DENG-MIT/NN-PSR">NN-PSR repo</a></p><h3 id="Combustion-Diagnostics-support-CEMA-and-CSP"><a class="docs-heading-anchor" href="#Combustion-Diagnostics-support-CEMA-and-CSP">Combustion Diagnostics support- CEMA and CSP</a><a id="Combustion-Diagnostics-support-CEMA-and-CSP-1"></a><a class="docs-heading-anchor-permalink" href="#Combustion-Diagnostics-support-CEMA-and-CSP" title="Permalink"></a></h3></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../install/">« Installation</a><a class="docs-footer-nextpage" href="../concepts/">Concepts »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Sunday 16 May 2021 05:37">Sunday 16 May 2021</span>. Using Julia version 1.5.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
